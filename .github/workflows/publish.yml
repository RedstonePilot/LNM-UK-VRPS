name: Publish CSV

on:
    push:
        branches:
            -main
    workflow_dispatch:

jobs:
    build:
        runs-on: ubuntu-latest
        
        steps:
            - name: Checkout code
              uses: actions/checkout@v2

     

            - name: Gen release
              id: gen_release
              uses: actions/create-release@v1
              env:
                GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
              with:
                tag_name: ${{ github.ref_name }}
                release_name: Release ${{ github.ref_name }}
                draft: false
                prerelease: false

            - name: Upload Release Asset
              id: upload-release-asset 
              uses: actions/upload-release-asset@v1
              env:
                GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
              with:
                asset_name: vrps.csv
                asset_content_type: text/csv
                upload_url: ${{ steps.gen_release.outputs.upload_url }} 
                asset_path: ./vrps.csv