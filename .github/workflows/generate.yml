name: Generate and Publish CSV

on:
    schedule:
        - cron: "0 0 * * *"
    workflow_dispatch:

jobs:
    publish_csv:
        runs-on: ubuntu-latest

        steps:
            - name: Checkout repository
              uses: actions/checkout@v2

            - name: Update CSV
              id: update
              run: |
                OUTPUT=$(python vrps.py)
                echo "result=$OUTPUT" >> $GITHUB_ENV
                            
            
            - name: Commit and push changes
              run: |
                git config --local user.email "action@github.com"
                git config --local user.name "GitHub Action"
                git add .
                git commit -m "Update CSV" --allow-empty
                git push